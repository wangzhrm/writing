<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conjunction Guessing Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
        }
        .scoreboard-item.active {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.7); /* blue-500 */
            border-color: #3B82F6; /* blue-500 */
        }
        .letter-input {
            width: 4rem;
            height: 5rem;
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            border-radius: 0.5rem;
            border: 2px solid #D1D5DB; /* gray-300 */
            background-color: #F9FAFB; /* gray-50 */
            color: #1F2937; /* gray-800 */
            caret-color: #3B82F6; /* blue-500 */
            transition: all 0.2s ease-in-out;
        }
        .letter-input:focus {
            outline: none;
            border-color: #3B82F6; /* blue-500 */
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.4);
        }
        .letter-input.revealed {
            background-color: #E5E7EB; /* gray-200 */
            border-color: #9CA3AF; /* gray-400 */
            color: #374151; /* gray-700 */
        }
        .modal {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            align-items: center;
            justify-content: center;
            z-index: 50;
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex items-center justify-center min-h-screen">

    <!-- Setup Modal -->
    <div id="setupModal" class="modal">
        <div class="bg-white p-8 rounded-2xl shadow-2xl text-center w-full max-w-md transform transition-all scale-100 opacity-100">
            <h2 class="text-3xl font-bold mb-4 text-slate-700">Welcome!</h2>
            <p class="mb-6 text-slate-500">How many groups are playing today?</p>
            <input type="number" id="groupCountInput" min="1" max="10" value="2" class="w-full p-3 text-center text-xl border-2 border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
            <button id="startGameBtn" class="w-full mt-6 bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                Start Game
            </button>
        </div>
    </div>

    <!-- Main Game Screen (hidden by default) -->
    <div id="gameScreen" class="hidden w-full h-screen flex flex-col p-4 md:p-8">
        <!-- Scoreboard -->
        <div id="scoreboard" class="flex justify-center items-center gap-4 mb-6 flex-wrap"></div>
        
        <!-- Game Content -->
        <div class="flex-grow flex flex-col items-center justify-center bg-white rounded-2xl shadow-xl p-6">
            <div id="turnIndicator" class="text-3xl font-bold mb-4 text-blue-600 transition-all duration-300"></div>
            <div id="categoryDisplay" class="text-center mb-4">
                <p class="text-xl text-slate-500">Category</p>
                <h3 class="text-4xl font-bold"></h3>
            </div>
            
            <div id="timer" class="text-7xl font-bold my-6 bg-slate-100 w-32 h-32 rounded-full flex items-center justify-center shadow-inner transition-colors duration-300">20</div>
            
            <div id="wordDisplay" class="flex justify-center items-center gap-2 mb-8 flex-wrap"></div>
            
            <button id="confirmBtn" class="bg-green-500 text-white font-bold py-3 px-12 rounded-lg text-xl hover:bg-green-600 transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-green-300">Confirm</button>
        </div>
    </div>

    <!-- Word Result Modal -->
    <div id="resultModal" class="modal hidden">
        <div class="bg-white p-8 rounded-2xl shadow-2xl text-center w-full max-w-2xl transform transition-all scale-95 opacity-0">
            <h2 id="resultTitle" class="text-4xl font-bold mb-4"></h2>
            <p class="text-2xl font-semibold text-slate-700 mb-2">The word was: <span id="correctWord" class="text-blue-600"></span></p>
            <p class="text-lg text-slate-500 mb-6">Meaning: <span id="wordMeaning"></span></p>
            <div class="bg-slate-100 p-4 rounded-lg">
                <p class="text-slate-600 font-semibold mb-2">Example Sentence:</p>
                <p id="exampleSentence" class="text-lg text-slate-800"></p>
            </div>
            <button id="nextWordBtn" class="w-full mt-8 bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                Next Word
            </button>
        </div>
    </div>

    <!-- Final Score Modal -->
    <div id="finalScoreModal" class="modal hidden">
        <div class="bg-white p-8 rounded-2xl shadow-2xl text-center w-full max-w-lg transform transition-all scale-95 opacity-0">
            <h2 class="text-4xl font-bold mb-4 text-slate-800">Game Over!</h2>
            <p class="text-xl mb-6 text-slate-500">Here are the final scores:</p>
            <div id="finalScoresContainer" class="space-y-3 mb-8"></div>
            <h3 id="winnerDeclaration" class="text-3xl font-bold text-amber-500"></h3>
        </div>
    </div>

<script>
    // --- DOM Elements ---
    const setupModal = document.getElementById('setupModal');
    const gameScreen = document.getElementById('gameScreen');
    const groupCountInput = document.getElementById('groupCountInput');
    const startGameBtn = document.getElementById('startGameBtn');
    const scoreboard = document.getElementById('scoreboard');
    const turnIndicator = document.getElementById('turnIndicator');
    const categoryDisplay = document.getElementById('categoryDisplay').querySelector('h3');
    const timerDisplay = document.getElementById('timer');
    const wordDisplay = document.getElementById('wordDisplay');
    const confirmBtn = document.getElementById('confirmBtn');
    const resultModal = document.getElementById('resultModal');
    const finalScoreModal = document.getElementById('finalScoreModal');

    // --- Game Data ---
    const conjunctionsData = [
        { category: "并列/顺承 (Adding Information)", word: "and", example: "He is tall and handsome." },
        { category: "并列/顺承 (Adding Information)", word: "moreover", example: "The report is badly written. Moreover, it's inaccurate." },
        { category: "并列/顺承 (Adding Information)", word: "furthermore", example: "He was cold and tired, and furthermore, he was hungry." },
        { category: "并列/顺承 (Adding Information)", word: "in addition", example: "In addition to his apartment in Manhattan, he has a villa in Italy." },
        { category: "并列/顺承 (Adding Information)", word: "as well as", example: "She is a talented musician as well as a painter." },
        { category: "并列/顺承 (Adding Information)", word: "not only but also", example: "He is not only a great student but also an amazing athlete." },
        { category: "对比/转折 (Showing Contrast)", word: "but", example: "The movie was good, but the book was better." },
        { category: "对比/转折 (Showing Contrast)", word: "however", example: "He said he would come; however, he didn't show up." },
        { category: "对比/转折 (Showing Contrast)", word: "although", example: "Although it was raining, they went for a walk." },
        { category: "对比/转折 (Showing Contrast)", word: "though", example: "Though he is young, he is very responsible." },
        { category: "对比/转折 (Showing Contrast)", word: "even though", example: "Even though she was tired, she finished her homework." },
        { category: "对比/转折 (Showing Contrast)", word: "whereas", example: "My brother loves spicy food, whereas I prefer mild dishes." },
        { category: "对比/转折 (Showing Contrast)", word: "while", example: "While I understand your point, I don't agree with it." },
        { category: "对比/转折 (Showing Contrast)", word: "on the other hand", example: "The job is demanding. On the other hand, it's very rewarding." },
        { category: "对比/转折 (Showing Contrast)", word: "in contrast", example: "In contrast to its neighbors, this house is very modern." },
        { category: "对比/转折 (Showing Contrast)", word: "nevertheless", example: "It was a difficult test; nevertheless, she passed." },
        { category: "对比/转折 (Showing Contrast)", word: "despite", example: "Despite the bad weather, the game went on." },
        { category: "对比/转折 (Showing Contrast)", word: "in spite of", example: "In spite of the delay, we arrived on time." },
        { category: "因果 (Showing Cause and Effect)", word: "because", example: "I am late because of the traffic." },
        { category: "因果 (Showing Cause and Effect)", word: "since", example: "Since you're here, you can help me." },
        { category: "因果 (Showing Cause and Effect)", word: "as", example: "As it was getting late, we decided to go home." },
        { category: "因果 (Showing Cause and Effect)", word: "therefore", example: "He was busy; therefore, he couldn't come." },
        { category: "因果 (Showing Cause and Effect)", word: "thus", example: "She studied hard and thus passed the exam." },
        { category: "因果 (Showing Cause and Effect)", word: "hence", example: "The roads were icy, hence the accident." },
        { category: "因果 (Showing Cause and Effect)", word: "consequently", example: "He forgot his keys and consequently was locked out." },
        { category: "因果 (Showing Cause and Effect)", word: "as a result", example: "He didn't study. As a result, he failed." },
        { category: "因果 (Showing Cause and Effect)", word: "due to", example: "The game was canceled due to the rain." },
        { category: "因果 (Showing Cause and Effect)", word: "owing to", example: "Owing to the storm, the flight was delayed." },
        { category: "假设/前提 (Showing Condition)", word: "if", example: "If it rains, we will stay home." },
        { category: "假设/前提 (Showing Condition)", word: "unless", example: "You will not pass unless you study." },
        { category: "假设/前提 (Showing Condition)", word: "provided that", example: "You can go out, provided that you finish your homework." },
        { category: "假设/前提 (Showing Condition)", word: "as long as", example: "I will help you as long as you are honest with me." },
        { category: "假设/前提 (Showing Condition)", word: "in case", example: "Take an umbrella in case it rains." },
        { category: "假设/前提 (Showing Condition)", word: "whether or not", example: "We will go, whether or not it rains." },
        { category: "表目的 (Showing Purpose)", word: "so that", example: "I studied hard so that I could pass the exam." },
        { category: "表目的 (Showing Purpose)", word: "in order to", example: "She woke up early in order to catch the train." },
        { category: "表目的 (Showing Purpose)", word: "for the purpose of", example: "The meeting was called for the purpose of discussing the new policy." },
        { category: "举例 (Showing Examples)", word: "for example", example: "There are many types of fruit, for example, apples and bananas." },
        { category: "举例 (Showing Examples)", word: "for instance", example: "He loves sports; for instance, he plays basketball and soccer." },
        { category: "举例 (Showing Examples)", word: "such as", example: "She enjoys hobbies such as reading and painting." },
        { category: "举例 (Showing Examples)", word: "namely", example: "There were two main reasons for his success, namely, hard work and luck." },
        { category: "总结 (Showing Conclusion / Summary)", word: "in conclusion", example: "In conclusion, I would like to thank everyone for their hard work." },
        { category: "总结 (Showing Conclusion / Summary)", word: "to sum up", example: "To sum up, the project was a great success." },
        { category: "总结 (Showing Conclusion / Summary)", word: "in summary", example: "In summary, we need to improve our communication." },
        { category: "总结 (Showing Conclusion / Summary)", word: "overall", example: "Overall, the event was well-organized." },
        { category: "总结 (Showing Conclusion / Summary)", word: "on the whole", example: "On the whole, I was pleased with the results." },
        { category: "总结 (Showing Conclusion / Summary)", word: "in short", example: "In short, the plan failed." },
        { category: "总结 (Showing Conclusion / Summary)", word: "all in all", example: "All in all, it was a memorable trip." },
    ];
    let availableWords = [...conjunctionsData];
    
    // --- Game State ---
    let gameState = {
        numGroups: 0,
        scores: [],
        currentGroup: 0,
        currentWordData: null,
        revealedLettersCount: 1,
        turnsInRound: 0,
        timer: null,
        timeLeft: 20,
        lastWordGuessed: false,
    };

    // --- Functions ---
    function initializeGame() {
        gameState.numGroups = parseInt(groupCountInput.value);
        if (gameState.numGroups < 1) return;
        
        gameState.scores = new Array(gameState.numGroups).fill(0);
        renderScoreboard();

        setupModal.classList.add('hidden');
        gameScreen.classList.remove('hidden');

        nextWord();
    }

    function renderScoreboard() {
        scoreboard.innerHTML = '';
        for (let i = 0; i < gameState.numGroups; i++) {
            const scoreDiv = document.createElement('div');
            scoreDiv.id = `group-score-${i}`;
            scoreDiv.className = 'scoreboard-item bg-white p-4 rounded-lg shadow-md text-center transition-all duration-300 border-2 border-transparent';
            scoreDiv.innerHTML = `
                <p class="text-sm font-semibold text-slate-500">Group ${i + 1}</p>
                <p class="text-3xl font-bold">${gameState.scores[i]}</p>
            `;
            scoreboard.appendChild(scoreDiv);
        }
    }

    function nextWord() {
        if (availableWords.length === 0) {
            endGame();
            return;
        }

        const wordIndex = Math.floor(Math.random() * availableWords.length);
        gameState.currentWordData = availableWords[wordIndex];
        availableWords.splice(wordIndex, 1); // Remove word so it's not picked again

        gameState.revealedLettersCount = 1;
        
        if (!gameState.lastWordGuessed) {
            gameState.currentGroup = 0; // Reset to group 1 if last round had no winner
        }
        // If lastWordGuessed is true, currentGroup is already the winner, so we don't change it.
        
        gameState.lastWordGuessed = false; // Reset for the new round
        gameState.turnsInRound = 0;
        
        categoryDisplay.textContent = gameState.currentWordData.category;
        
        renderWordDisplay();
        startTurn();
        hideModal(resultModal);
    }
    
    function renderWordDisplay() {
        wordDisplay.innerHTML = '';
        const word = gameState.currentWordData.word;

        for (let i = 0; i < word.length; i++) {
            if (word[i] === ' ') {
                const space = document.createElement('div');
                space.className = 'w-8';
                wordDisplay.appendChild(space);
            } else {
                const input = document.createElement('input');
                input.type = 'text';
                input.maxLength = 1;
                input.className = 'letter-input';
                input.dataset.index = i;

                if (i < gameState.revealedLettersCount) {
                    input.value = word[i];
                    input.disabled = true;
                    input.classList.add('revealed');
                }
                
                wordDisplay.appendChild(input);
            }
        }
        setupInputListeners();
    }

    function setupInputListeners() {
        const inputs = document.querySelectorAll('.letter-input:not(.revealed)');
        inputs.forEach((input, index) => {
            input.addEventListener('input', () => {
                clearInterval(gameState.timer); // Stop timer on first input
                if (input.value && index < inputs.length - 1) {
                    inputs[index + 1].focus();
                }
            });
            input.addEventListener('keydown', (e) => {
                 if (e.key === 'Backspace' && !input.value && index > 0) {
                    inputs[index - 1].focus();
                 }
            });
        });
        if (inputs.length > 0) {
            inputs[0].focus();
        }
    }
    
    function startTurn() {
        updateTurnIndicator();
        resetTimer();
        gameState.timer = setInterval(updateTimer, 1000);
    }
    
    function updateTurnIndicator() {
        document.querySelectorAll('.scoreboard-item').forEach((el, i) => {
            el.classList.toggle('active', i === gameState.currentGroup);
        });
        turnIndicator.textContent = `Group ${gameState.currentGroup + 1}'s Turn`;
    }

    function resetTimer() {
        clearInterval(gameState.timer);
        gameState.timeLeft = 20;
        timerDisplay.textContent = gameState.timeLeft;
        timerDisplay.classList.remove('text-red-500');
    }

    function updateTimer() {
        gameState.timeLeft--;
        timerDisplay.textContent = gameState.timeLeft;
        if (gameState.timeLeft <= 5) {
             timerDisplay.classList.add('text-red-500');
        }
        if (gameState.timeLeft <= 0) {
            passTurn();
        }
    }

    function checkAnswer() {
        clearInterval(gameState.timer);
        let guess = '';
        const inputs = document.querySelectorAll('.letter-input');
        inputs.forEach(input => {
            guess += input.value;
        });

        const word = gameState.currentWordData.word.replace(/\s/g, '');
        
        if (guess.toLowerCase() === word.toLowerCase()) {
            // Correct answer
            gameState.scores[gameState.currentGroup]++;
            gameState.lastWordGuessed = true;
            renderScoreboard();
            showWordResult(true);
        } else {
            // Incorrect answer
            passTurn();
        }
    }
    
    function clearInputs() {
        const inputs = document.querySelectorAll('.letter-input:not(.revealed)');
        inputs.forEach(input => {
            input.value = '';
        });
        if (inputs.length > 0) {
            inputs[0].focus();
        }
    }

    function passTurn() {
        resetTimer();
        gameState.currentGroup = (gameState.currentGroup + 1) % gameState.numGroups;
        gameState.turnsInRound++;

        if (gameState.turnsInRound >= gameState.numGroups) {
            // Full round completed
            gameState.revealedLettersCount++;
            gameState.turnsInRound = 0;
            if (gameState.revealedLettersCount >= gameState.currentWordData.word.replace(/\s/g, '').length) {
                showWordResult(false); // All letters revealed
                return;
            }
            renderWordDisplay();
        } else {
            // Clear previous group's attempt for the next group in the same round
            clearInputs();
        }
        startTurn();
    }
    
    function showWordResult(wasGuessed) {
        document.getElementById('resultTitle').textContent = wasGuessed ? `Correct! +1 for Group ${gameState.currentGroup + 1}` : 'Time for the next word!';
        document.getElementById('correctWord').textContent = gameState.currentWordData.word;
        document.getElementById('wordMeaning').textContent = gameState.currentWordData.category.split('(')[0].trim();
        document.getElementById('exampleSentence').textContent = gameState.currentWordData.example;
        
        const nextBtn = document.getElementById('nextWordBtn');
        if (availableWords.length > 0) {
            nextBtn.textContent = 'Next Word';
        } else {
            nextBtn.textContent = 'See Final Scores';
        }

        showModal(resultModal);
    }
    
    function endGame() {
        gameScreen.classList.add('hidden');
        hideModal(resultModal);
        
        const container = document.getElementById('finalScoresContainer');
        container.innerHTML = '';
        
        let maxScore = -1;
        let winners = [];

        gameState.scores.forEach((score, i) => {
            const scoreDiv = document.createElement('div');
            scoreDiv.className = 'flex justify-between items-center bg-slate-100 p-3 rounded-lg';
            scoreDiv.innerHTML = `
                <span class="text-xl font-semibold">Group ${i + 1}</span>
                <span class="text-2xl font-bold">${score} Points</span>
            `;
            container.appendChild(scoreDiv);

            if (score > maxScore) {
                maxScore = score;
                winners = [i + 1];
            } else if (score === maxScore) {
                winners.push(i + 1);
            }
        });

        const winnerText = winners.length > 1 
            ? `It's a tie between Groups ${winners.join(' & ')}!`
            : `Group ${winners[0]} is the winner!`;
        document.getElementById('winnerDeclaration').textContent = winnerText;
        
        showModal(finalScoreModal);
    }

    function showModal(modal) {
        modal.classList.remove('hidden');
        setTimeout(() => {
            modal.querySelector('div').classList.remove('scale-95', 'opacity-0');
            modal.querySelector('div').classList.add('scale-100', 'opacity-100');
        }, 10);
    }

    function hideModal(modal) {
        const innerDiv = modal.querySelector('div');
        if (innerDiv) {
            innerDiv.classList.add('scale-95', 'opacity-0');
            innerDiv.classList.remove('scale-100', 'opacity-100');
        }
        setTimeout(() => modal.classList.add('hidden'), 200);
    }

    // --- Event Listeners ---
    startGameBtn.addEventListener('click', initializeGame);
    confirmBtn.addEventListener('click', checkAnswer);
    document.getElementById('nextWordBtn').addEventListener('click', nextWord);

</script>
</body>
</html>


